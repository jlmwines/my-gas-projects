<div id="orders-widget-container" style="padding: 0;">
  <div class="card">
    <div class="card-header">
      <h5>Orders</h5>
    </div>
    <div class="card-body" id="orders-widget-body">
      <p>Loading Orders Widget...</p>
    </div>
  </div>
</div>

<script>
  /**
   * Populates the orders widget with new data from the backend.
   * @param {Object} data - The orders data from the backend.
   */
  function updateOrdersWidget(data) {
    const widgetBody = document.getElementById('orders-widget-body'); // Targeting the body
    if (!data) {
      widgetBody.innerHTML = `<p class="text-danger">Error: No data received from server.</p>`;
      return;
    }
    if (data.error) {
      widgetBody.innerHTML = `<p class="text-danger">${data.error}</p>`;
      return;
    }

    let countsHtml = ''; // Remove the h5 and hr, as they are now in the card structure
    countsHtml += '<p>On-Hold Orders: <strong>' + (data.onHoldCount || 0) + '</strong></p>';
    countsHtml += '<p>Processing Orders: <strong>' + (data.processingCount || 0) + '</strong></p>';
    countsHtml += '<p>Packing Slips Ready: <strong>' + (data.packingSlipsReadyCount || 0) + '</strong></p>';
    
    // --- Rebuild the widget with new structure (preserves a clean slate) ---
    widgetBody.innerHTML = countsHtml + 
      '<hr>' + // Divider below widget content
      '<div id="comax-persistent-count-area" style="margin-bottom: 0.5rem;">Comax Orders to Export: ' + (data.comaxExportOrderCount || 0) + '</div>';
  }

  // Initial data load for this view
  google.script.run.withSuccessHandler(updateOrdersWidget).withFailureHandler(showError).WebAppOrders_getOrdersWidgetData();
</script>